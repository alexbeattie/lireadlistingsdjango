<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real Estate Listings</title>
    <link rel="stylesheet" href="{% static 'css/output.css' %}" type="text/css">
</head>
<body class="bg-gray-100 min-h-screen p-4">
<div class="container mx-auto">
    <h1 class="text-3xl font-bold text-center mb-8">Real Estate Listings</h1>
<div class="mb-8 text-center">
    <p class="text-lg font-semibold mb-2">Sort by:</p>
    <a href="?sort=-price{% if request.GET.page %}&page={{ request.GET.page }}{% endif %}"
       class="inline-block px-4 py-2 mr-2 {% if current_sort == '-price' %}bg-blue-500 text-white{% else %}bg-gray-200 text-gray-700{% endif %} rounded-full">
        Price (High to Low)
    </a>
    <a href="?sort=price{% if request.GET.page %}&page={{ request.GET.page }}{% endif %}"
       class="inline-block px-4 py-2 mr-2 {% if current_sort == 'price' %}bg-blue-500 text-white{% else %}bg-gray-200 text-gray-700{% endif %} rounded-full">
        Price (Low to High)
    </a>
    <a href="?sort=-list_date{% if request.GET.page %}&page={{ request.GET.page }}{% endif %}"
       class="inline-block px-4 py-2 mr-2 {% if current_sort == '-list_date' %}bg-blue-500 text-white{% else %}bg-gray-200 text-gray-700{% endif %} rounded-full">
        Newest First
    </a>
    <a href="?sort=list_date{% if request.GET.page %}&page={{ request.GET.page }}{% endif %}"
       class="inline-block px-4 py-2 {% if current_sort == 'list_date' %}bg-blue-500 text-white{% else %}bg-gray-200 text-gray-700{% endif %} rounded-full">
        Oldest First
    </a>
</div>
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        {% for listing in listings %}
        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <a href="{% url 'listing_detail' listing.id %}" class="block">
                {% if listing.main_image %}
                <img src="{{ listing.main_image.url }}" alt="Main photo of {{ listing.title }}"
                     class="w-full h-48 object-cover">
                {% else %}
                <div class="w-full h-48 bg-gray-300 flex items-center justify-center">
                    <p class="text-gray-500">No image available</p>
                </div>
                {% endif %}
                <div class="p-4">
                    <h2 class="text-xl font-semibold mb-2">{{ listing.title }}</h2>
                    <p class="text-green-600 font-bold mb-2">${{ listing.price }}</p>
                    <p class="text-gray-600 mb-1">{{ listing.bedrooms }} bed, {{ listing.bathrooms }} bath</p>
                    <p class="text-gray-600">{{ listing.city }}, {{ listing.state }}</p>
                </div>
            </a>
        </div>
        {% empty %}
        <p class="col-span-full text-center text-gray-500">No listings available.</p>
        {% endfor %}
    </div>

   {% if listings.has_other_pages %}
<div class="flex justify-center mt-8">
    <nav class="inline-flex rounded-md shadow">
        {% if listings.has_previous %}
        <a href="?page={{ listings.previous_page_number }}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}"
           class="px-3 py-2 rounded-l-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50">&laquo; Previous</a>
        {% endif %}

        {% for i in listings.paginator.page_range %}
        {% if listings.number == i %}
        <span class="px-3 py-2 border border-gray-300 bg-blue-50 text-blue-600">{{ i }}</span>
        {% else %}
        <a href="?page={{ i }}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}"
           class="px-3 py-2 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50">{{ i }}</a>
        {% endif %}
        {% endfor %}

        {% if listings.has_next %}
        <a href="?page={{ listings.next_page_number }}{% if request.GET.sort %}&sort={{ request.GET.sort }}{% endif %}"
           class="px-3 py-2 rounded-r-md border border-gray-300 bg-white text-gray-700 hover:bg-gray-50">Next &raquo;</a>
        {% endif %}
    </nav>
</div>
{% endif %}
</div>
</body>
</html>